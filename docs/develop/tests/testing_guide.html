<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Credex API Testing Guide</title>
    <link rel="stylesheet" href="../../style.css" />
    <script src="../../menu.js"></script>
  </head>
  <body>
    <div class="header-logo">
      <img src="../../images/logo.png" alt="Credex Logo" class="secondary-logo" />
    </div>
    <h1>Credex API Testing Guide</h1>

    <h2>Test Architecture</h2>

    <p>
      The Credex test suite is organized into three main categories:
    </p>

    <ul>
      <li><strong>Endpoint Tests</strong>: Individual API endpoint tests that can be run in isolation or as part of larger flows</li>
      <li><strong>Integration Tests</strong>: End-to-end scenarios testing multiple endpoints in sequence</li>
      <li><strong>DevAdmin Operations</strong>: Administrative commands for test environment setup</li>
    </ul>

    <p>
      Tests are structured in the following directories:
    </p>

    <pre><code>tests/
  api/
    endpoints/          # Individual endpoint tests
    basic/             # Integration test scenarios
    utils/             # Shared test utilities</code></pre>

    <h2>Local Development Testing</h2>

    <p>
      During local development, tests run against your local API server. Basic test commands:
    </p>

    <pre><code># Run all integration tests
npm test basic

# Test a specific endpoint
npm test member onboardMember Test Member1 1234567890 USD

# Reset test environment
npm test clearforce</code></pre>

    <h2>Testing Against Deployed Environments</h2>

    <p>
      To test against deployed environments, add the environment prefix to any test command:
    </p>

    <ul>
      <li><strong>Development</strong>: dev.mycredex.dev - prefix commands with <code>dev</code></li>
      <li><strong>Staging</strong>: stage.mycredex.dev - prefix commands with <code>stage</code></li>
    </ul>

    <p>
      Examples of testing against the development environment:
    </p>

    <pre><code># Run integration tests on dev
npm test dev basic

# Test endpoint on dev
npm test dev member onboardMember Test Member1 1234567890 USD

# Reset dev environment
npm test dev clearforce</code></pre>

    <p>
      Note: Tests on deployed environments run with --runInBand to prevent concurrency issues.
    </p>

    <h2>Command Reference</h2>

    <p>
      All commands below can be run against any environment by adding the environment prefix (dev/stage).
    </p>

    <h3>DevAdmin Operations</h3>
    <pre><code>npm test cleardevdbs     # Clear test databases
npm test forcedco        # Force Daily Credcoin Offering
npm test clearforce      # Clear DBs and force DCO</code></pre>

    <h3>Member Operations</h3>
    <pre><code>npm test member onboardMember firstname lastname phone defaultDenom
npm test member getMemberByHandle phone memberHandle
npm test member getMemberDashboardByPhone phone</code></pre>

    <h3>Account Operations</h3>
    <pre><code>npm test account getAccountByHandle phone accountHandle
npm test account getLedger phone accountID</code></pre>

    <h3>Credex Operations</h3>
    <pre><code>npm test credex createCredex phone issuerAccountID receiverAccountID Denomination InitialAmount credexType OFFERSorREQUESTS securedCredex
npm test credex acceptCredex phone credexID
npm test credex acceptCredexBulk phone credexIDs
npm test credex declineCredex phone credexID
npm test credex cancelCredex phone credexID
npm test credex getCredex phone credexID</code></pre>

    <h3>Integration Tests</h3>
    <pre><code>npm test basic           # Run all integration test scenarios</code></pre>

  </body>
</html>
