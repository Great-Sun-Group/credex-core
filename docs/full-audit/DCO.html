<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Credcoin Offering (DCO)</title>
    <link rel="stylesheet" href="style.css">
    <script src="../menu.js"></script>
</head>
<body>
    <h1>Daily Credcoin Offering (DCO)</h1>

    <p>The Daily Credcoin Offering (DCO) is a crucial component of the Credex ecosystem that runs every 24 hours at midnight UTC, while most of the world's population centres are in darkness.</p>

    <p>The DCO checks for an active daynode as a proxy for an active or empty database, and if no daynode exists the <code>DBinitialization</code> function is called. Then the script calls <code>DCOexecute</code>.</p>

    <h2>DBinitialization.ts</h2>

    <p>The DBinitialization file sets up the initial state of the database for the Credex ecosystem.</p>

    <ol>
        <li>Sets up database constraints and indexes for various entities (Daynode, Member, Account).</li>
        <li>Establishes "day zero" and initializes exchange rates for various currencies against CXX (Credcoin).</li>
        <li>Creates an initial "daynode" with the day zero exchange rates.</li>
        <li>Creates three initial members and updates their member tiers.</li>
        <li>Creates initial accounts including for the Credex Foundation and secured credex issuance for participation in the first DCO.</li>
        <li>Establishes relationships between these accounts, particularly marking some as "CREDEX_FOUNDATION_AUDITED" to determine which accounts can originally issue secured credexes.</li>
        <li>Creates an initial Credex transaction to fund the DCO for a year.</li>
    </ol>

    <p>This initialization process sets up the basic structure and relationships needed for the Credex ecosystem to function, including the establishment of exchange rates and the creation of foundational accounts and transactions.</p>

    <h2>DCOexecute.ts</h2>

    <p>The DCOexecute function implements the Daily Credcoin Offering (DCO) process.</p>

    <ol>
        <li>Check if the Minute Transaction Queue (MTQ) is running and wait if it is and retry in a few seconds.</li>
        <li>Set the DCOrunningNow flag and fetch the current and next date.</li>
        <li>Perform an end-of-day backup.</li>
        <li>Process defaulting unsecured credexes and expire pending offers/requests.</li>
        <li>Fetch current exchange rates for various currencies.</li>
        <li>Fetch declared DCO participants and filter them based on available secured balance.</li>
        <li>Calculate new CXX (Credcoin) rates based on the total DCO amount and number of participants.</li>
        <li>Create a new daynode with the updated CXX rates.</li>
        <li>Create DCO give transactions from participants to the Credex Foundation.</li>
        <li>Update credex and asset balances across the system to reflect the new exchange rates.</li>
        <li>Create DCO receive transactions from the Credex Foundation to participants.</li>
        <li>Perform a start-of-day backup for the new day.</li>
    </ol>

    <p>This process implements the Credcoin Principle by:</p>

    <ul>
        <li>Allowing participants to contribute value to the ecosystem (DCO give transactions).</li>
        <li>Distributing an equal share of the new value to all participants (DCO receive transactions).</li>
        <li>Adjusting the value of Credcoin relative to other currencies based on the total contribution and number of participants.</li>
        <li>Updating all existing balances and transactions to maintain their relative value in the new exchange rate environment.</li>
    </ul>

    <p>The DCO process ensures that the value of one Credcoin is always equal to the number of participants divided by the value of natural wealth entering the organic economy through the DCO, as stated in the Credcoin Principle.</p>

    <p>This implementation allows for a dynamic, daily adjustment of the ecosystem's internal economy, reflecting the contributions and participation of its members while maintaining the relative value of existing transactions and balances.</p>

    <h1>Exchange Rate Calculation Explanations for DCOexecute.ts</h1>

    <h2>processDCOParticipants function</h2>

    <ol>
        <li><strong>denomsInXAU</strong>: Calculates exchange rates for all denominations in terms of XAU (gold).
            This standardizes all rates to a common base (gold) for easier comparison and calculation.
            <pre><code>Formula: denomsInXAU[currency] = USDbaseRates[currency] / USDbaseRates.XAU</code></pre>
        </li>

        <li><strong>DCOinXAU calculation</strong>:
            Converts each participant's contribution to XAU for a common measure.
            <pre><code>Formula: DCOinXAU += DCOgiveInDenom / denomsInXAU[DCOdenom]</code></pre>
        </li>

        <li><strong>nextCXXinXAU</strong>:
            Calculates the new CXX value in terms of XAU. This represents the new gold peg of the new day's CXX, which is used to set it's relative value against all currency deonominations and assets.
            <pre><code>Formula: nextCXXinXAU = DCOinXAU / numberConfirmedParticipants</code></pre>
        </li>

        <li><strong>CXXprior_CXXcurrent</strong>:
            Calculates the ratio between the previous day's CXX and the current day's CXX.
            This ratio is used to adjust existing CXX balances.
            <pre><code>Formula: CXXprior_CXXcurrent = DCOinCXX / numberConfirmedParticipants</code></pre>
        </li>

        <li><strong>newCXXrates</strong>:
            Calculates new exchange rates for all denominations in terms of CXX.
            For each denomination:
            <ol type="a">
                <li>Take its XAU rate (denomsInXAU[denom])</li>
                <li>Divide by the new CXX-to-XAU rate (nextCXXinXAU)</li>
                <li>Invert the result to get CXX per denomination unit</li>
            </ol>
            <pre><code>Formula: newCXXrates[denom] = 1 / (nextCXXinXAU * denomsInXAU[denom])</code></pre>
        </li>
    </ol>

    <h2>updateCredexBalances function</h2>
    <p><strong>to be reviewed</strong></p>

    <ol>
        <li><strong>CXX credexes</strong> are adjusted by dividing all CXX amounts by CXXprior_CXXcurrent.
            This adjusts the CXX balances to the new CXX value.</li>
    </ol>

    <p>These calculations ensure that all credexes and balances are properly adjusted
    to reflect the new exchange rates after each Daily Credcoin Offering (DCO).</p>

</body>
</html>
